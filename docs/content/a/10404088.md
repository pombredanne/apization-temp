---
title: "[Q#10358345][A#10404088] Making authenticated POST requests with Spring RestTemplate for Android"
question_title: "Making authenticated POST requests with Spring RestTemplate for Android"
question_text: "I have a RESTful API I'm trying to connect with via Android and RestTemplate. All requests to the API are authenticated with HTTP Authentication, through setting the headers of the HttpEntity and then using RestTemplate's exchange() method. All GET requests work great this way, but I cannot figure out how to accomplish authenticated POST requests. postForObject and postForEntity handle POSTs, but have no easy way to set the Authentication headers. So for GETs, this works great: But POSTs apparently don't work with exchange() as it never sends the customized headers and I don't see how to set the request body using exchange(). What is the easiest way to make authenticated POST requests from RestTemplate?"
answer_text: "Ok found the answer. exchange() is the best way. Oddly the HttpEntity class doesn't have a setBody() method (it has getBody()), but it is still possible to set the request body, via the constructor."
apization_code: "package com.stackoverflow.api;  import org.apache.commons.collections4.map.MultiValueMap;  /**  * Making authenticated POST requests with Spring RestTemplate for Android  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/10404088\">https://stackoverflow.com/a/10404088</a>  */ public class APIzator10404088 {    public static MyModel makeRequest() throws RuntimeException {     // Create the request body as a MultiValueMap     MultiValueMap<String, String> body = new LinkedMultiValueMap<String, String>();     body.add(\"field\", \"value\");     // Note the body object as first parameter!     HttpEntity<?> httpEntity = new HttpEntity<Object>(body, requestHeaders);     return restTemplate.exchange(       \"/api/url\",       HttpMethod.POST,       httpEntity,       MyModel.class     );   } }"
---

https://stackoverflow.com/q/10358345

I have a RESTful API I&#x27;m trying to connect with via Android and RestTemplate. All requests to the API are authenticated with HTTP Authentication, through setting the headers of the HttpEntity and then using RestTemplate&#x27;s exchange() method.
All GET requests work great this way, but I cannot figure out how to accomplish authenticated POST requests. postForObject and postForEntity handle POSTs, but have no easy way to set the Authentication headers.
So for GETs, this works great:
But POSTs apparently don&#x27;t work with exchange() as it never sends the customized headers and I don&#x27;t see how to set the request body using exchange().
What is the easiest way to make authenticated POST requests from RestTemplate?


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
HttpAuthentication httpAuthentication = new HttpBasicAuthentication("username", "password");
HttpHeaders requestHeaders = new HttpHeaders();
requestHeaders.setAuthorization(httpAuthentication);

HttpEntity<?> httpEntity = new HttpEntity<Object>(requestHeaders);

MyModel[] models = restTemplate.exchange("/api/url", HttpMethod.GET, httpEntity, MyModel[].class);
```


## Original code snippet

https://stackoverflow.com/a/10404088

Ok found the answer. exchange() is the best way. Oddly the HttpEntity class doesn&#x27;t have a setBody() method (it has getBody()), but it is still possible to set the request body, via the constructor.

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
// Create the request body as a MultiValueMap
MultiValueMap<String, String> body = new LinkedMultiValueMap<String, String>();     

body.add("field", "value");

// Note the body object as first parameter!
HttpEntity<?> httpEntity = new HttpEntity<Object>(body, requestHeaders);

MyModel model = restTemplate.exchange("/api/url", HttpMethod.POST, httpEntity, MyModel.class);
```

## Produced APIzation

[`APIzator10404088.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/search/APIzator10404088.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

import org.apache.commons.collections4.map.MultiValueMap;

/**
 * Making authenticated POST requests with Spring RestTemplate for Android
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/10404088">https://stackoverflow.com/a/10404088</a>
 */
public class APIzator10404088 {

  public static MyModel makeRequest() throws RuntimeException {
    // Create the request body as a MultiValueMap
    MultiValueMap<String, String> body = new LinkedMultiValueMap<String, String>();
    body.add("field", "value");
    // Note the body object as first parameter!
    HttpEntity<?> httpEntity = new HttpEntity<Object>(body, requestHeaders);
    return restTemplate.exchange(
      "/api/url",
      HttpMethod.POST,
      httpEntity,
      MyModel.class
    );
  }
}

```