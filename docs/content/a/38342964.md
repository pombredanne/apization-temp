---
title: "[Q#9481865][A#38342964] Getting the IP address of the current machine using Java"
question_title: "Getting the IP address of the current machine using Java"
question_text: "I am trying to develop a system where there are different nodes that are run on different system or on different ports on the same system. Now all the nodes create a Socket with a target IP as the IP of a special node known as a bootstrapping node. The nodes then create their own ServerSocket and start listening for connections. The bootstrapping node maintains a list of Nodes and returns them on being queried. Now what I need is the node must register its IP to the bootstrapping node. I tried using cli.getInetAddress() once the client connects to the ServerSocket of bootstrapping node but that didn't work. Using the code: or My PPP Connection IP address is: 117.204.44.192 but the above returns me 192.168.1.2 EDIT I am using the following code: I am able to get all the IP addresses associated all NetworkInterfaces, but how do I distinguish them? This is the output I am getting:"
answer_text: "This way works well when there are multiple network interfaces. It always returns the preferred outbound IP. The destination 8.8.8.8 is not needed to be reachable. Connect on a UDP socket has the following effect: it sets the destination for Send/Recv, discards all packets from other addresses, and - which is what we use - transfers the socket into \"connected\" state, settings its appropriate fields. This includes checking the existence of the route to the destination according to the system's routing table and setting the local endpoint accordingly. The last part seems to be undocumented officially but it looks like an integral trait of Berkeley sockets API (a side effect of UDP \"connected\" state) that works reliably in both Windows and Linux across versions and distributions. So, this method will give the local address that would be used to connect to the specified remote host. There is no real connection established, hence the specified remote ip can be unreachable."
apization_code: "package com.stackoverflow.api;  import java.net.DatagramSocket; import java.net.InetAddress;  /**  * Getting the IP address of the current machine using Java  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/38342964\">https://stackoverflow.com/a/38342964</a>  */ public class APIzator38342964 {    public static void getAddress() throws RuntimeException {     try (final DatagramSocket socket = new DatagramSocket()) {       socket.connect(InetAddress.getByName(\"8.8.8.8\"), 10002);       ip = socket.getLocalAddress().getHostAddress();     }   } }"
---

https://stackoverflow.com/q/9481865

I am trying to develop a system where there are different nodes that are run on different system or on different ports on the same system.
Now all the nodes create a Socket with a target IP as the IP of a special node known as a bootstrapping node. The nodes then create their own ServerSocket and start listening for connections.
The bootstrapping node maintains a list of Nodes and returns them on being queried.
Now what I need is the node must register its IP to the bootstrapping node. I tried using cli.getInetAddress() once the client connects to the ServerSocket of bootstrapping node but that didn&#x27;t work.
Using the code:
or
My PPP Connection IP address is: 117.204.44.192 but the above returns me 192.168.1.2
EDIT
I am using the following code:
I am able to get all the IP addresses associated all NetworkInterfaces, but how do I distinguish them? This is the output I am getting:


```java
System.out.println(Inet4Address.getLocalHost().getHostAddress());
System.out.println(InetAddress.getLocalHost().getHostAddress());
Enumeration e = NetworkInterface.getNetworkInterfaces();
while(e.hasMoreElements())
{
    NetworkInterface n = (NetworkInterface) e.nextElement();
    Enumeration ee = n.getInetAddresses();
    while (ee.hasMoreElements())
    {
        InetAddress i = (InetAddress) ee.nextElement();
        System.out.println(i.getHostAddress());
    }
}
127.0.0.1
192.168.1.2
192.168.56.1
117.204.44.19
```


## Original code snippet

https://stackoverflow.com/a/38342964

This way works well when there are multiple network interfaces. It always returns the preferred outbound IP. The destination 8.8.8.8 is not needed to be reachable.
Connect on a UDP socket has the following effect: it sets the destination for Send/Recv, discards all packets from other addresses, and - which is what we use - transfers the socket into &quot;connected&quot; state, settings its appropriate fields. This includes checking the existence of the route to the destination according to the system&#x27;s routing table and setting the local endpoint accordingly. The last part seems to be undocumented officially but it looks like an integral trait of Berkeley sockets API (a side effect of UDP &quot;connected&quot; state) that works reliably in both Windows and Linux across versions and distributions.
So, this method will give the local address that would be used to connect to the specified remote host. There is no real connection established, hence the specified remote ip can be unreachable.

```java
import java.net.DatagramSocket;

try(final DatagramSocket socket = new DatagramSocket()){
  socket.connect(InetAddress.getByName("8.8.8.8"), 10002);
  ip = socket.getLocalAddress().getHostAddress();
}
```

## Produced APIzation

[`APIzator38342964.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator38342964.java)

```java
package com.stackoverflow.api;

import java.net.DatagramSocket;
import java.net.InetAddress;

/**
 * Getting the IP address of the current machine using Java
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/38342964">https://stackoverflow.com/a/38342964</a>
 */
public class APIzator38342964 {

  public static void getAddress() throws RuntimeException {
    try (final DatagramSocket socket = new DatagramSocket()) {
      socket.connect(InetAddress.getByName("8.8.8.8"), 10002);
      ip = socket.getLocalAddress().getHostAddress();
    }
  }
}

```