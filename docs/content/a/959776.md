---
title: "[Q#959731][A#959776] How to replace a set of tokens in a Java String?"
question_title: "How to replace a set of tokens in a Java String?"
question_text: "I have the following template String: \"Hello [Name] Please find attached [Invoice Number] which is due on [Due Date]\". I also have String variables for name, invoice number and due date - what's the best way to replace the tokens in the template with the variables? (Note that if a variable happens to contain a token it should NOT be replaced). EDIT With thanks to @laginimaineb and @alan-moore, here's my solution:"
answer_text: "The most efficient way would be using a matcher to continually find the expressions and replace them, then append the text to a string builder:"
apization_code: "package com.stackoverflow.api;  import java.util.HashMap; import java.util.regex.Matcher; import java.util.regex.Pattern;  /**  * How to replace a set of tokens in a Java String?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/959776\">https://stackoverflow.com/a/959776</a>  */ public class APIzator959776 {    public static void replaceSet() throws RuntimeException {     Pattern pattern = Pattern.compile(\"\\\\[(.+?)\\\\]\");     Matcher matcher = pattern.matcher(text);     HashMap<String, String> replacements = new HashMap<String, String>();     // populate the replacements map ...     StringBuilder builder = new StringBuilder();     int i = 0;     while (matcher.find()) {       String replacement = replacements.get(matcher.group(1));       builder.append(text.substring(i, matcher.start()));       if (replacement == null) builder.append(         matcher.group(0)       ); else builder.append(replacement);       i = matcher.end();     }     builder.append(text.substring(i, text.length()));     return builder.toString();   } }"
---

https://stackoverflow.com/q/959731

I have the following template String: &quot;Hello [Name] Please find attached [Invoice Number] which is due on [Due Date]&quot;.
I also have String variables for name, invoice number and due date - what&#x27;s the best way to replace the tokens in the template with the variables?
(Note that if a variable happens to contain a token it should NOT be replaced).
EDIT
With thanks to @laginimaineb and @alan-moore, here&#x27;s my solution:


```java
public static String replaceTokens(String text, 
                                   Map<String, String> replacements) {
    Pattern pattern = Pattern.compile("\\[(.+?)\\]");
    Matcher matcher = pattern.matcher(text);
    StringBuffer buffer = new StringBuffer();

    while (matcher.find()) {
        String replacement = replacements.get(matcher.group(1));
        if (replacement != null) {
            // matcher.appendReplacement(buffer, replacement);
            // see comment 
            matcher.appendReplacement(buffer, "");
            buffer.append(replacement);
        }
    }
    matcher.appendTail(buffer);
    return buffer.toString();
}
```


## Original code snippet

https://stackoverflow.com/a/959776

The most efficient way would be using a matcher to continually find the expressions and replace them, then append the text to a string builder:

```java
Pattern pattern = Pattern.compile("\\[(.+?)\\]");
Matcher matcher = pattern.matcher(text);
HashMap<String,String> replacements = new HashMap<String,String>();
//populate the replacements map ...
StringBuilder builder = new StringBuilder();
int i = 0;
while (matcher.find()) {
    String replacement = replacements.get(matcher.group(1));
    builder.append(text.substring(i, matcher.start()));
    if (replacement == null)
        builder.append(matcher.group(0));
    else
        builder.append(replacement);
    i = matcher.end();
}
builder.append(text.substring(i, text.length()));
return builder.toString();
```

## Produced APIzation

[`APIzator959776.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator959776.java)

```java
package com.stackoverflow.api;

import java.util.HashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * How to replace a set of tokens in a Java String?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/959776">https://stackoverflow.com/a/959776</a>
 */
public class APIzator959776 {

  public static void replaceSet() throws RuntimeException {
    Pattern pattern = Pattern.compile("\\[(.+?)\\]");
    Matcher matcher = pattern.matcher(text);
    HashMap<String, String> replacements = new HashMap<String, String>();
    // populate the replacements map ...
    StringBuilder builder = new StringBuilder();
    int i = 0;
    while (matcher.find()) {
      String replacement = replacements.get(matcher.group(1));
      builder.append(text.substring(i, matcher.start()));
      if (replacement == null) builder.append(
        matcher.group(0)
      ); else builder.append(replacement);
      i = matcher.end();
    }
    builder.append(text.substring(i, text.length()));
    return builder.toString();
  }
}

```