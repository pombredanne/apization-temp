---
title: "[Q#4355046][A#4355097] Java: Insert multiple rows into MySQL with PreparedStatement"
question_title: "Java: Insert multiple rows into MySQL with PreparedStatement"
question_text: "I want to insert multiple rows into a MySQL table at once using Java. The number of rows is dynamic. In the past I was doing... I'd like to optimize this to use the MySQL-supported syntax: but with a PreparedStatement I don't know of any way to do this since I don't know beforehand how many elements array will contain. If it's not possible with a PreparedStatement, how else can I do it (and still escape the values in the array)?"
answer_text: "You can create a batch by PreparedStatement#addBatch() and execute it by PreparedStatement#executeBatch(). Here's a kickoff example: It's executed every 1000 items because some JDBC drivers and/or DBs may have a limitation on batch length. See also:"
apization_code: "package com.stackoverflow.api;  import android.content.Entity; import com.sun.xml.internal.bind.v2.schemagen.xmlschema.List; import java.sql.Connection; import java.sql.PreparedStatement; import java.sql.SQLException;  /**  * Java: Insert multiple rows into MySQL with PreparedStatement  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/4355097\">https://stackoverflow.com/a/4355097</a>  */ public class APIzator4355097 {    public static void save(List<Entity> entities) throws SQLException {     try (       Connection connection = database.getConnection();       PreparedStatement statement = connection.prepareStatement(SQL_INSERT)     ) {       int i = 0;       for (Entity entity : entities) {         statement.setString(1, entity.getSomeProperty());         // ...         statement.addBatch();         i++;         if (i % 1000 == 0 || i == entities.size()) {           // Execute every 1000 items.           statement.executeBatch();         }       }     }   } }"
---

https://stackoverflow.com/q/4355046

I want to insert multiple rows into a MySQL table at once using Java. The number of rows is dynamic. In the past I was doing...
I&#x27;d like to optimize this to use the MySQL-supported syntax:
but with a PreparedStatement I don&#x27;t know of any way to do this since I don&#x27;t know beforehand how many elements array will contain. If it&#x27;s not possible with a PreparedStatement, how else can I do it (and still escape the values in the array)?


```java
for (String element : array) {
    myStatement.setString(1, element[0]);
    myStatement.setString(2, element[1]);

    myStatement.executeUpdate();
}
INSERT INTO table (col1, col2) VALUES ('val1', 'val2'), ('val1', 'val2')[, ...]
```


## Original code snippet

https://stackoverflow.com/a/4355097

You can create a batch by PreparedStatement#addBatch() and execute it by PreparedStatement#executeBatch().
Here&#x27;s a kickoff example:
It&#x27;s executed every 1000 items because some JDBC drivers and/or DBs may have a limitation on batch length.
See also:

```java
public void save(List<Entity> entities) throws SQLException {
    try (
        Connection connection = database.getConnection();
        PreparedStatement statement = connection.prepareStatement(SQL_INSERT);
    ) {
        int i = 0;

        for (Entity entity : entities) {
            statement.setString(1, entity.getSomeProperty());
            // ...

            statement.addBatch();
            i++;

            if (i % 1000 == 0 || i == entities.size()) {
                statement.executeBatch(); // Execute every 1000 items.
            }
        }
    }
}
```

## Produced APIzation

[`APIzator4355097.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator4355097.java)

```java
package com.stackoverflow.api;

import android.content.Entity;
import com.sun.xml.internal.bind.v2.schemagen.xmlschema.List;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

/**
 * Java: Insert multiple rows into MySQL with PreparedStatement
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/4355097">https://stackoverflow.com/a/4355097</a>
 */
public class APIzator4355097 {

  public static void save(List<Entity> entities) throws SQLException {
    try (
      Connection connection = database.getConnection();
      PreparedStatement statement = connection.prepareStatement(SQL_INSERT)
    ) {
      int i = 0;
      for (Entity entity : entities) {
        statement.setString(1, entity.getSomeProperty());
        // ...
        statement.addBatch();
        i++;
        if (i % 1000 == 0 || i == entities.size()) {
          // Execute every 1000 items.
          statement.executeBatch();
        }
      }
    }
  }
}

```