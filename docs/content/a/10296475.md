---
title: "[Q#10258101][A#10296475] SSLHandshakeException: No subject alternative names present"
question_title: "SSLHandshakeException: No subject alternative names present"
question_text: "I am invoking HTTPS SOAP web service through java code. I have already imported self-signed certificate in jre cacerts keystore. Now I am getting : The hostname of the service URL is not matching that of the CN provided in cert. I read about a workaround of defining a custom Hostname verifier here. But i cant able to make where I should implement the workaround in my code. Please ignore WSBean parameter as the namespaces and other wsdl attributes are coming from this bean. And if this exception can solved with some different workarounds, pls do suggest."
answer_text: "Thanks,Bruno for giving me heads up on Common Name and Subject Alternative Name. As we figured out certificate was generated with CN with DNS name of network and asked for regeneration of new certificate with Subject Alternative Name entry i.e. san=ip:10.0.0.1. which is the actual solution. But, we managed to find out a workaround with which we can able to run on development phase. Just add a static block in the class from which we are making ssl connection. If you happen to be using Java 8, there is a much slicker way of achieving the same result:"
apization_code: "package com.stackoverflow.api;  import javax.net.ssl.HostnameVerifier; import javax.net.ssl.HttpsURLConnection; import javax.net.ssl.SSLSession;  /**  * SSLHandshakeException: No subject alternative names present  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/10296475\">https://stackoverflow.com/a/10296475</a>  */ public class APIzator10296475 {    static {     HttpsURLConnection.setDefaultHostnameVerifier(       new HostnameVerifier() {          public static boolean verify(String hostname, SSLSession session) {           // ip address of the service URL(like.23.28.244.244)           if (hostname.equals(\"23.28.244.244\")) return true;           return false;         }       }     );   }    static {     HttpsURLConnection.setDefaultHostnameVerifier(       (hostname, session) -> hostname.equals(\"127.0.0.1\")     );   } }"
---

https://stackoverflow.com/q/10258101

I am invoking HTTPS SOAP web service through java code. I have already imported self-signed certificate in jre cacerts keystore. Now I am getting :
The hostname of the service URL is not matching that of the CN provided in cert. I read about a workaround of defining a custom Hostname verifier here. But i cant able to make where I should implement the workaround in my code.
Please ignore WSBean parameter as the namespaces and other wsdl attributes are coming from this bean. And if this exception can solved with some different workarounds, pls do suggest.


```java
com.sun.xml.internal.ws.com.client.ClientTransportException: HTTP transport error: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No subject alternative names present
public SOAPMessage invokeWS(WSBean bean) throws Exception {

    SOAPMessage response=null;
    try{

    /** Create a service and add at least one port to it. **/
    String targetNameSpace = bean.getTargetNameSpace();
    String endpointUrl = bean.getEndpointUrl();
    QName serviceName = new QName(targetNameSpace, bean.getServiceName());
    QName portName = new QName(targetNameSpace, bean.getPortName());
    String SOAPAction = bean.getSOAPAction();
    HashMap<String, String> map = bean.getParameters();


    Service service = Service.create(serviceName);
    service.addPort(portName, SOAPBinding.SOAP11HTTP_BINDING, endpointUrl);

    /** Create a Dispatch instance from a service. **/
    Dispatch dispatch = service.createDispatch(portName, SOAPMessage.class,
            Service.Mode.MESSAGE);

    // The soapActionUri is set here. otherwise we get a error on .net based
    // services.
    dispatch.getRequestContext().put(Dispatch.SOAPACTION_USE_PROPERTY,
            new Boolean(true));
    dispatch.getRequestContext().put(Dispatch.SOAPACTION_URI_PROPERTY,
            SOAPAction);

    /** Create SOAPMessage request. **/
    // compose a request message
    MessageFactory messageFactory = MessageFactory.newInstance();
    SOAPMessage message = messageFactory.createMessage();

    // Create objects for the message parts
    SOAPPart soapPart = message.getSOAPPart();
    SOAPEnvelope envelope = soapPart.getEnvelope();
    SOAPBody body = envelope.getBody();

    SOAPElement bodyElement = body.addChildElement(bean.getInputMethod(),
            bean.getPrefix(), bean.getTargetNameSpace());

             ...more code to form soap body goes here

    // Print request
    message.writeTo(System.out);

    // Save the message
    message.saveChanges();

    response = (SOAPMessage)dispatch.invoke(message);
    }
    catch (Exception e) {
        log.error("Error in invokeSiebelWS :"+e);
    }
    return response;
}
```


## Original code snippet

https://stackoverflow.com/a/10296475

Thanks,Bruno for giving me heads up on Common Name and Subject Alternative Name. As we figured out certificate was generated with CN with DNS name of network and asked for regeneration of new certificate with Subject Alternative Name entry i.e. san=ip:10.0.0.1. which is the actual solution.
But, we managed to find out a workaround with which we can able to run on development phase. Just add a static block in the class from which we are making ssl connection.
If you happen to be using Java 8, there is a much slicker way of achieving the same result:

```java
static {
    HttpsURLConnection.setDefaultHostnameVerifier(new HostnameVerifier()
        {
            public boolean verify(String hostname, SSLSession session)
            {
                // ip address of the service URL(like.23.28.244.244)
                if (hostname.equals("23.28.244.244"))
                    return true;
                return false;
            }
        });
}
static {
    HttpsURLConnection.setDefaultHostnameVerifier((hostname, session) -> hostname.equals("127.0.0.1"));
}
```

## Produced APIzation

[`APIzator10296475.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator10296475.java)

```java
package com.stackoverflow.api;

import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.SSLSession;

/**
 * SSLHandshakeException: No subject alternative names present
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/10296475">https://stackoverflow.com/a/10296475</a>
 */
public class APIzator10296475 {

  static {
    HttpsURLConnection.setDefaultHostnameVerifier(
      new HostnameVerifier() {

        public static boolean verify(String hostname, SSLSession session) {
          // ip address of the service URL(like.23.28.244.244)
          if (hostname.equals("23.28.244.244")) return true;
          return false;
        }
      }
    );
  }

  static {
    HttpsURLConnection.setDefaultHostnameVerifier(
      (hostname, session) -> hostname.equals("127.0.0.1")
    );
  }
}

```