---
title: "[Q#9520911][A#9526674] Java sending and receiving file (byte[]) over sockets"
question_title: "Java sending and receiving file (byte[]) over sockets"
question_text: "I am trying to develop a very simple client / server where the client converts a file to bytes, sends it to the server, and then converts the bytes back in to a file. Currently the program just creates an empty file. I'm not a fantastic Java developer so any help much appreciated. This is the server part that receives what the client sends. And here is the client part"
answer_text: "The correct way to copy a stream in Java is as follows: Wish I had a dollar for every time I've posted that in a forum."
apization_code: "package com.stackoverflow.api;  /**  * Java sending and receiving file (byte[]) over sockets  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/9526674\">https://stackoverflow.com/a/9526674</a>  */ public class APIzator9526674 {    public static void java(byte[] buffer) throws RuntimeException {     int count;     while ((count = in.read(buffer)) > 0) {       out.write(buffer, 0, count);     }   } }"
---

https://stackoverflow.com/q/9520911

I am trying to develop a very simple client / server where the client converts a file to bytes, sends it to the server, and then converts the bytes back in to a file.
Currently the program just creates an empty file. I&#x27;m not a fantastic Java developer so any help much appreciated.
This is the server part that receives what the client sends.
And here is the client part


```java
ServerSocket serverSocket = null;

    serverSocket = new ServerSocket(4444);


    Socket socket = null;
    socket = serverSocket.accept();

    DataOutputStream out = new DataOutputStream(new BufferedOutputStream(socket.getOutputStream()));
    DataInputStream in = new DataInputStream(new BufferedInputStream(socket.getInputStream()));
    byte[] bytes = new byte[1024];

    in.read(bytes);
    System.out.println(bytes);

    FileOutputStream fos = new FileOutputStream("C:\\test2.xml");
    fos.write(bytes);
Socket socket = null;
    DataOutputStream out = null;
    DataInputStream in = null;
    String host = "127.0.0.1";     

    socket = new Socket(host, 4444);
    out = new DataOutputStream(new BufferedOutputStream(socket.getOutputStream()));
    in = new DataInputStream(new BufferedInputStream(socket.getInputStream()));

    File file = new File("C:\\test.xml");
    //InputStream is = new FileInputStream(file);
    // Get the size of the file
    long length = file.length();
    if (length > Integer.MAX_VALUE) {
        System.out.println("File is too large.");
    }
    byte[] bytes = new byte[(int) length];

    //out.write(bytes);
    System.out.println(bytes);

    out.close();
    in.close();
    socket.close();
```


## Original code snippet

https://stackoverflow.com/a/9526674

The correct way to copy a stream in Java is as follows:
Wish I had a dollar for every time I&#x27;ve posted that in a forum.

```java
int count;
byte[] buffer = new byte[8192]; // or 4096, or more
while ((count = in.read(buffer)) > 0)
{
  out.write(buffer, 0, count);
}
```

## Produced APIzation

[`APIzator9526674.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator9526674.java)

```java
package com.stackoverflow.api;

/**
 * Java sending and receiving file (byte[]) over sockets
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/9526674">https://stackoverflow.com/a/9526674</a>
 */
public class APIzator9526674 {

  public static void java(byte[] buffer) throws RuntimeException {
    int count;
    while ((count = in.read(buffer)) > 0) {
      out.write(buffer, 0, count);
    }
  }
}

```