---
title: "[Q#194698][A#194712] How to load a jar file at runtime"
question_title: "How to load a jar file at runtime"
question_text: "I was asked to build a java system that will have the ability to load new code (expansions) while running.  How do I re-load a jar file while my code is running? or how do I load a new jar? Obviously, since constant up-time is important, I'd like to add the ability to re-load existing classes while at it (if it does not complicate things too much). What are the things I should look out for? (think of it as two different questions - one regarding reloading classes at runtime, the other regarding adding new classes)."
answer_text: "Reloading existing classes with existing data is likely to break things. You can load new code into new class loaders relatively easily: Class loaders no longer used can be garbage collected (unless there is a memory leak, as is often the case with using ThreadLocal, JDBC drivers, java.beans, etc). If you want to keep the object data, then I suggest a persistence mechanism such as Serialisation, or whatever you are used to. Of course debugging systems can do fancier things, but are more hacky and less reliable. It is possible to add new classes into a class loader. For instance, using URLClassLoader.addURL. However, if a class fails to load (because, say, you haven't added it), then it will never load in that class loader instance."
apization_code: "package com.stackoverflow.api;  import clojure.reflect.Constructor; import java.net.URLClassLoader;  /**  * How to load a jar file at runtime  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/194712\">https://stackoverflow.com/a/194712</a>  */ public class APIzator194712 {    public static void loadFile() throws RuntimeException {     ClassLoader loader = URLClassLoader.newInstance(       new URL[] { yourURL },       getClass().getClassLoader()     );     Class<?> clazz = Class.forName(\"mypackage.MyClass\", true, loader);     Class<? extends Runnable> runClass = clazz.asSubclass(Runnable.class);     // Avoid Class.newInstance, for it is evil.     Constructor<? extends Runnable> ctor = runClass.getConstructor();     Runnable doRun = ctor.newInstance();     doRun.run();   } }"
---

https://stackoverflow.com/q/194698

I was asked to build a java system that will have the ability to load new code (expansions) while running. 
How do I re-load a jar file while my code is running? or how do I load a new jar?
Obviously, since constant up-time is important, I&#x27;d like to add the ability to re-load existing classes while at it (if it does not complicate things too much).
What are the things I should look out for?
(think of it as two different questions - one regarding reloading classes at runtime, the other regarding adding new classes).



## Original code snippet

https://stackoverflow.com/a/194712

Reloading existing classes with existing data is likely to break things.
You can load new code into new class loaders relatively easily:
Class loaders no longer used can be garbage collected (unless there is a memory leak, as is often the case with using ThreadLocal, JDBC drivers, java.beans, etc).
If you want to keep the object data, then I suggest a persistence mechanism such as Serialisation, or whatever you are used to.
Of course debugging systems can do fancier things, but are more hacky and less reliable.
It is possible to add new classes into a class loader. For instance, using URLClassLoader.addURL. However, if a class fails to load (because, say, you haven&#x27;t added it), then it will never load in that class loader instance.

```java
ClassLoader loader = URLClassLoader.newInstance(
    new URL[] { yourURL },
    getClass().getClassLoader()
);
Class<?> clazz = Class.forName("mypackage.MyClass", true, loader);
Class<? extends Runnable> runClass = clazz.asSubclass(Runnable.class);
// Avoid Class.newInstance, for it is evil.
Constructor<? extends Runnable> ctor = runClass.getConstructor();
Runnable doRun = ctor.newInstance();
doRun.run();
```

## Produced APIzation

[`APIzator194712.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator194712.java)

```java
package com.stackoverflow.api;

import clojure.reflect.Constructor;
import java.net.URLClassLoader;

/**
 * How to load a jar file at runtime
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/194712">https://stackoverflow.com/a/194712</a>
 */
public class APIzator194712 {

  public static void loadFile() throws RuntimeException {
    ClassLoader loader = URLClassLoader.newInstance(
      new URL[] { yourURL },
      getClass().getClassLoader()
    );
    Class<?> clazz = Class.forName("mypackage.MyClass", true, loader);
    Class<? extends Runnable> runClass = clazz.asSubclass(Runnable.class);
    // Avoid Class.newInstance, for it is evil.
    Constructor<? extends Runnable> ctor = runClass.getConstructor();
    Runnable doRun = ctor.newInstance();
    doRun.run();
  }
}

```