---
title: "[Q#1110404][A#1110425] Remove Elements from a HashSet while Iterating"
question_title: "Remove Elements from a HashSet while Iterating"
question_text: "So, if I try to remove elements from a Java HashSet while iterating, I get a ConcurrentModificationException.  What is the best way to remove a subset of the elements from a HashSet as in the following example? Here is a solution, but I don't think it's very elegant: Thanks!"
answer_text: "You can manually iterate over the elements of the set: You will often see this pattern using a for loop rather than a while loop: As people have pointed out, using a for loop is preferred because it keeps the iterator variable (i in this case) confined to a smaller scope."
apization_code: "package com.stackoverflow.api;  import com.gargoylesoftware.htmlunit.javascript.host.Iterator;  /**  * Remove Elements from a HashSet while Iterating  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/1110425\">https://stackoverflow.com/a/1110425</a>  */ public class APIzator1110425 {    public static void removeElements() throws RuntimeException {     Iterator<Integer> iterator = set.iterator();     while (iterator.hasNext()) {       Integer element = iterator.next();       if (element % 2 == 0) {         iterator.remove();       }     }     for (Iterator<Integer> i = set.iterator(); i.hasNext();) {       Integer element = i.next();       if (element % 2 == 0) {         i.remove();       }     }   } }"
---

https://stackoverflow.com/q/1110404

So, if I try to remove elements from a Java HashSet while iterating, I get a ConcurrentModificationException.  What is the best way to remove a subset of the elements from a HashSet as in the following example?
Here is a solution, but I don&#x27;t think it&#x27;s very elegant:
Thanks!


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
Set<Integer> set = new HashSet<Integer>();

for(int i = 0; i < 10; i++)
    set.add(i);

// Throws ConcurrentModificationException
for(Integer element : set)
    if(element % 2 == 0)
        set.remove(element);
Set<Integer> set = new HashSet<Integer>();
Collection<Integer> removeCandidates = new LinkedList<Integer>();

for(int i = 0; i < 10; i++)
    set.add(i);

for(Integer element : set)
    if(element % 2 == 0)
        removeCandidates.add(element);

set.removeAll(removeCandidates);
```


## Original code snippet

https://stackoverflow.com/a/1110425

You can manually iterate over the elements of the set:
You will often see this pattern using a for loop rather than a while loop:
As people have pointed out, using a for loop is preferred because it keeps the iterator variable (i in this case) confined to a smaller scope.

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
Iterator<Integer> iterator = set.iterator();
while (iterator.hasNext()) {
    Integer element = iterator.next();
    if (element % 2 == 0) {
        iterator.remove();
    }
}
for (Iterator<Integer> i = set.iterator(); i.hasNext();) {
    Integer element = i.next();
    if (element % 2 == 0) {
        i.remove();
    }
}
```

## Produced APIzation

[`APIzator1110425.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/search/APIzator1110425.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

import com.gargoylesoftware.htmlunit.javascript.host.Iterator;

/**
 * Remove Elements from a HashSet while Iterating
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/1110425">https://stackoverflow.com/a/1110425</a>
 */
public class APIzator1110425 {

  public static void removeElements() throws RuntimeException {
    Iterator<Integer> iterator = set.iterator();
    while (iterator.hasNext()) {
      Integer element = iterator.next();
      if (element % 2 == 0) {
        iterator.remove();
      }
    }
    for (Iterator<Integer> i = set.iterator(); i.hasNext();) {
      Integer element = i.next();
      if (element % 2 == 0) {
        i.remove();
      }
    }
  }
}

```