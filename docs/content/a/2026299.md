---
title: "[Q#2026260][A#2026299] Java: how to use UrlConnection to post request with authorization?"
question_title: "Java: how to use UrlConnection to post request with authorization?"
question_text: "I would like to generate POST request to a server which requires authentication. I tried to use the following method: but the server doesn't receive the authorization data. The line which is supposed to add authorization data is the following: and the line also throws an IOException. Anyway I would be very thankful if anyone could suggest any fix of the logic above in order to enable authorization using POST with UrlConnection. but obviously it doesn't work as it is supposed to although if the same logic is used for GET request everything works fine."
answer_text: "A fine example found here. Powerlord got it right, below, for POST you need HttpURLConnection, instead. Below is the code to do that, Change URLConnection to HttpURLConnection, to make it POST request. Suggestion (...in comments): You might need to set these properties too,"
apization_code: "package com.stackoverflow.api;  import java.io.BufferedReader; import java.io.InputStreamReader; import java.io.OutputStreamWriter; import java.net.HttpURLConnection; import java.net.URLConnection;  /**  * Java: how to use UrlConnection to post request with authorization?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/2026299\">https://stackoverflow.com/a/2026299</a>  */ public class APIzator2026299 {    public static void java() throws RuntimeException {     URL url = new URL(urlString);     URLConnection conn = url.openConnection();     conn.setDoOutput(true);     conn.setRequestProperty(\"Authorization\", encodedCredentials);     OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());     writer.write(data);     writer.flush();     String line;     BufferedReader reader = new BufferedReader(       new InputStreamReader(conn.getInputStream())     );     while ((line = reader.readLine()) != null) {       System.out.println(line);     }     writer.close();     reader.close();     HttpURLConnection conn = (HttpURLConnection) url.openConnection();     conn.setRequestMethod(\"POST\");     conn.setRequestProperty(       \"Content-type\",       \"application/x-www-form-urlencoded\"     );     conn.setRequestProperty(\"Accept\", \"*/*\");   } }"
---

https://stackoverflow.com/q/2026260

I would like to generate POST request to a server which requires authentication. I tried to use the following method:
but the server doesn&#x27;t receive the authorization data. The line which is supposed to add authorization data is the following:
and the line
also throws an IOException.
Anyway I would be very thankful if anyone could suggest any fix of the logic above in order to enable authorization using POST with UrlConnection.
but obviously it doesn&#x27;t work as it is supposed to although if the same logic is used for GET request everything works fine.


```java
private synchronized String CreateNewProductPOST (String urlString, String encodedString, String title, String content, Double price, String tags) {

    String data = "product[title]=" + URLEncoder.encode(title) +
                "&product[content]=" + URLEncoder.encode(content) + 
                "&product[price]=" + URLEncoder.encode(price.toString()) +
                "&tags=" + tags;
    try {
        URL url = new URL(urlString);
        URLConnection conn;
        conn = url.openConnection();
        conn.setRequestProperty ("Authorization", "Basic " + encodedString);
        conn.setDoOutput(true);
        conn.setDoInput(true);
        OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        wr.write(data);
        wr.flush(); 
        // Get the response 
        BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream())); 
        String line; 
        while ((line = rd.readLine()) != null) { 
            // Process line... 
            } 
        wr.close(); 
        rd.close(); 
        return rd.toString();
    } catch (MalformedURLException e) {

        e.printStackTrace();
        return e.getMessage();
    }
    catch (IOException e) {

        e.printStackTrace();
        return e.getMessage();
    } 
}
conn.setRequestProperty ("Authorization", "Basic " + encodedString);
BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
```


## Original code snippet

https://stackoverflow.com/a/2026299

A fine example found here. Powerlord got it right, below, for POST you need HttpURLConnection, instead.
Below is the code to do that,
Change URLConnection to HttpURLConnection, to make it POST request.
Suggestion (...in comments):
You might need to set these properties too,

```java
URL url = new URL(urlString);
    URLConnection conn = url.openConnection();
    conn.setDoOutput(true);
    conn.setRequestProperty ("Authorization", encodedCredentials);

    OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());

    writer.write(data);
    writer.flush();
    String line;
    BufferedReader reader = new BufferedReader(new 
                                     InputStreamReader(conn.getInputStream()));
    while ((line = reader.readLine()) != null) {
      System.out.println(line);
    }
    writer.close();
    reader.close();
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
    conn.setRequestMethod("POST");
conn.setRequestProperty( "Content-type", "application/x-www-form-urlencoded");
conn.setRequestProperty( "Accept", "*/*" );
```

## Produced APIzation

[`APIzator2026299.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator2026299.java)

```java
package com.stackoverflow.api;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URLConnection;

/**
 * Java: how to use UrlConnection to post request with authorization?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/2026299">https://stackoverflow.com/a/2026299</a>
 */
public class APIzator2026299 {

  public static void java() throws RuntimeException {
    URL url = new URL(urlString);
    URLConnection conn = url.openConnection();
    conn.setDoOutput(true);
    conn.setRequestProperty("Authorization", encodedCredentials);
    OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());
    writer.write(data);
    writer.flush();
    String line;
    BufferedReader reader = new BufferedReader(
      new InputStreamReader(conn.getInputStream())
    );
    while ((line = reader.readLine()) != null) {
      System.out.println(line);
    }
    writer.close();
    reader.close();
    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
    conn.setRequestMethod("POST");
    conn.setRequestProperty(
      "Content-type",
      "application/x-www-form-urlencoded"
    );
    conn.setRequestProperty("Accept", "*/*");
  }
}

```