---
title: "[Q#7886462][A#7886509] How to get row count using ResultSet in Java?"
question_title: "How to get row count using ResultSet in Java?"
question_text: "I'm trying to create a simple method that receives a ResultSet as a parameter and returns an int that contains the row count of the ResultSet. Is this a valid way of doing this or not so much? I tried this: But I got an error saying com.microsoft.sqlserver.jdbc.SQLServerException: The requested operation is not supported on forward only result sets. Thanks in advance for the pointers!"
answer_text: "If you have access to the prepared statement that results in this resultset, you can use This prepares your statement in a way that you can rewind the cursor. This is also documented in the ResultSet Javadoc In general, however, forwarding and rewinding cursors may be quite inefficient for large result sets. Another option in SQL Server would be to calculate the total number of rows directly in your SQL statement:"
apization_code: "package com.stackoverflow.api;  import com.google.cloud.sql.jdbc.ResultSet;  /**  * How to get row count using ResultSet in Java?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/7886509\">https://stackoverflow.com/a/7886509</a>  */ public class APIzator7886509 {    public static void get() throws RuntimeException {     connection.prepareStatement(       sql,       ResultSet.TYPE_SCROLL_INSENSITIVE,       ResultSet.CONCUR_READ_ONLY     );   } }"
---

https://stackoverflow.com/q/7886462

I&#x27;m trying to create a simple method that receives a ResultSet as a parameter and returns an int that contains the row count of the ResultSet. Is this a valid way of doing this or not so much?
I tried this:
But I got an error saying com.microsoft.sqlserver.jdbc.SQLServerException: The requested operation is not supported on forward only result sets.
Thanks in advance for the pointers!


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
int size = 0;
    try {
        while(rs.next()){
            size++;
        }
    }
    catch(Exception ex) {
        System.out.println("------------------Tablerize.getRowCount-----------------");
        System.out.println("Cannot get resultSet row count: " + ex);
        System.out.println("--------------------------------------------------------");
    }
int size = 0;
try {
    resultSet.last();
    size = resultSet.getRow();
    resultSet.beforeFirst();
}
catch(Exception ex) {
    return 0;
}
return size;
```


## Original code snippet

https://stackoverflow.com/a/7886509

If you have access to the prepared statement that results in this resultset, you can use
This prepares your statement in a way that you can rewind the cursor. This is also documented in the ResultSet Javadoc
In general, however, forwarding and rewinding cursors may be quite inefficient for large result sets. Another option in SQL Server would be to calculate the total number of rows directly in your SQL statement:

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
connection.prepareStatement(sql, 
  ResultSet.TYPE_SCROLL_INSENSITIVE, 
  ResultSet.CONCUR_READ_ONLY);
SELECT my_table.*, count(*) over (partition by 1) total_rows
FROM my_table
WHERE ...
```

## Produced APIzation

[`APIzator7886509.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/search/APIzator7886509.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

import com.google.cloud.sql.jdbc.ResultSet;

/**
 * How to get row count using ResultSet in Java?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/7886509">https://stackoverflow.com/a/7886509</a>
 */
public class APIzator7886509 {

  public static void get() throws RuntimeException {
    connection.prepareStatement(
      sql,
      ResultSet.TYPE_SCROLL_INSENSITIVE,
      ResultSet.CONCUR_READ_ONLY
    );
  }
}

```