---
title: "[Q#12059278][A#12060103] How to POST JSON request using Apache HttpClient?"
question_title: "How to POST JSON request using Apache HttpClient?"
question_text: "I have something like the following: It keeps coming back with a 500. The service provider says I need to send JSON. How is that done with Apache HttpClient 3.1+?"
answer_text: "Apache HttpClient doesn't know anything about JSON, so you'll need to construct your JSON separately. To do so, I recommend checking out the simple JSON-java library from json.org. (If \"JSON-java\" doesn't suit you, json.org has a big list of libraries available in different languages.) Once you've generated your JSON, you can use something like the code below to POST it Edit Note - The above answer, as asked for in the question, applies to Apache HttpClient 3.1. However, to help anyone looking for an implementation against the latest Apache client:"
apization_code: "package com.stackoverflow.api;  /**  * How to POST JSON request using Apache HttpClient?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/12060103\">https://stackoverflow.com/a/12060103</a>  */ public class APIzator12060103 {    public static HttpResponse postRequest() throws RuntimeException {     StringRequestEntity requestEntity = new StringRequestEntity(       JSON_STRING,       \"application/json\",       \"UTF-8\"     );     PostMethod postMethod = new PostMethod(\"http://example.com/action\");     postMethod.setRequestEntity(requestEntity);     int statusCode = httpClient.executeMethod(postMethod);     StringEntity requestEntity = new StringEntity(       JSON_STRING,       ContentType.APPLICATION_JSON     );     HttpPost postMethod = new HttpPost(\"http://example.com/action\");     postMethod.setEntity(requestEntity);     return httpclient.execute(postMethod);   } }"
---

https://stackoverflow.com/q/12059278

I have something like the following:
It keeps coming back with a 500. The service provider says I need to send JSON. How is that done with Apache HttpClient 3.1+?


```java
final String url = "http://example.com";

final HttpClient httpClient = new HttpClient();
final PostMethod postMethod = new PostMethod(url);
postMethod.addRequestHeader("Content-Type", "application/json");
postMethod.addParameters(new NameValuePair[]{
        new NameValuePair("name", "value)
});
httpClient.executeMethod(httpMethod);
postMethod.getResponseBodyAsStream();
postMethod.releaseConnection();
```


## Original code snippet

https://stackoverflow.com/a/12060103

Apache HttpClient doesn&#x27;t know anything about JSON, so you&#x27;ll need to construct your JSON separately. To do so, I recommend checking out the simple JSON-java library from json.org. (If &quot;JSON-java&quot; doesn&#x27;t suit you, json.org has a big list of libraries available in different languages.)
Once you&#x27;ve generated your JSON, you can use something like the code below to POST it
Edit
Note - The above answer, as asked for in the question, applies to Apache HttpClient 3.1. However, to help anyone looking for an implementation against the latest Apache client:

```java
StringRequestEntity requestEntity = new StringRequestEntity(
    JSON_STRING,
    "application/json",
    "UTF-8");

PostMethod postMethod = new PostMethod("http://example.com/action");
postMethod.setRequestEntity(requestEntity);

int statusCode = httpClient.executeMethod(postMethod);
StringEntity requestEntity = new StringEntity(
    JSON_STRING,
    ContentType.APPLICATION_JSON);

HttpPost postMethod = new HttpPost("http://example.com/action");
postMethod.setEntity(requestEntity);

HttpResponse rawResponse = httpclient.execute(postMethod);
```

## Produced APIzation

[`APIzator12060103.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator12060103.java)

```java
package com.stackoverflow.api;

/**
 * How to POST JSON request using Apache HttpClient?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/12060103">https://stackoverflow.com/a/12060103</a>
 */
public class APIzator12060103 {

  public static HttpResponse postRequest() throws RuntimeException {
    StringRequestEntity requestEntity = new StringRequestEntity(
      JSON_STRING,
      "application/json",
      "UTF-8"
    );
    PostMethod postMethod = new PostMethod("http://example.com/action");
    postMethod.setRequestEntity(requestEntity);
    int statusCode = httpClient.executeMethod(postMethod);
    StringEntity requestEntity = new StringEntity(
      JSON_STRING,
      ContentType.APPLICATION_JSON
    );
    HttpPost postMethod = new HttpPost("http://example.com/action");
    postMethod.setEntity(requestEntity);
    return httpclient.execute(postMethod);
  }
}

```