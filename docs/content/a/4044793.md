---
title: "[Q#4044726][A#4044793] How to set a Timer in Java?"
question_title: "How to set a Timer in Java?"
question_text: "How to set a Timer, say for 2 minutes, to try to connect to a Database then throw exception if there is any issue in connection?"
answer_text: "So the first part of the answer is how to do what the subject asks as this was how I initially interpreted it and a few people seemed to find helpful.  The question was since clarified and I've extended the answer to address that. Setting a timer First you need to create a Timer (I'm using the java.util version here): .. To run the task once you would do: To have the task repeat after the duration you would do: Making a task timeout To specifically do what the clarified question asks, that is attempting to perform a task for a given period of time, you could do the following: This will execute normally with exceptions if the task completes within 2 minutes.  If it runs longer than that, the TimeoutException will be throw. One issue is that although you'll get a TimeoutException after the two minutes, the task will actually continue to run, although presumably a database or network connection will eventually time out and throw an exception in the thread.  But be aware it could consume resources until that happens."
apization_code: "package com.stackoverflow.api;  import io.netty.util.Timer; import io.netty.util.TimerTask; import java.util.concurrent.ExecutionException; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.Future; import java.util.concurrent.TimeUnit; import java.util.concurrent.TimeoutException;  /**  * How to set a Timer in Java?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/4044793\">https://stackoverflow.com/a/4044793</a>  */ public class APIzator4044793 {    public static void setTimer() throws RuntimeException {     Timer timer = new Timer();     timer.schedule(       new TimerTask() {          @Override         public void run() {           // Your database code here         }       },       2 * 60 * 1000     );     timer.scheduleAtFixedRate(       new TimerTask() {          @Override         public void run() {           // Your database code here         }       },       2 * 60 * 1000,       2 * 60 * 1000     );     ExecutorService service = Executors.newSingleThreadExecutor();     try {       Runnable r = new Runnable() {          @Override         public void run() {           // Database task         }       };       Future<?> f = service.submit(r);       // attempt the task for two minutes       f.get(2, TimeUnit.MINUTES);     } catch (final InterruptedException e) {       // The thread was interrupted during sleep, wait or join     } catch (final TimeoutException e) {       // Took too long!     } catch (final ExecutionException e) {       // An exception from within the Runnable task     } finally {       service.shutdown();     }   } }"
---

https://stackoverflow.com/q/4044726

How to set a Timer, say for 2 minutes, to try to connect to a Database then throw exception if there is any issue in connection?



## Original code snippet

https://stackoverflow.com/a/4044793

So the first part of the answer is how to do what the subject asks as this was how I initially interpreted it and a few people seemed to find helpful.  The question was since clarified and I&#x27;ve extended the answer to address that.
Setting a timer
First you need to create a Timer (I&#x27;m using the java.util version here):
..
To run the task once you would do:
To have the task repeat after the duration you would do:
Making a task timeout
To specifically do what the clarified question asks, that is attempting to perform a task for a given period of time, you could do the following:
This will execute normally with exceptions if the task completes within 2 minutes.  If it runs longer than that, the TimeoutException will be throw.
One issue is that although you&#x27;ll get a TimeoutException after the two minutes, the task will actually continue to run, although presumably a database or network connection will eventually time out and throw an exception in the thread.  But be aware it could consume resources until that happens.

```java
import java.util.Timer;
Timer timer = new Timer();
timer.schedule(new TimerTask() {
  @Override
  public void run() {
    // Your database code here
  }
}, 2*60*1000);
timer.scheduleAtFixedRate(new TimerTask() {
  @Override
  public void run() {
    // Your database code here
  }
}, 2*60*1000, 2*60*1000);
ExecutorService service = Executors.newSingleThreadExecutor();

try {
    Runnable r = new Runnable() {
        @Override
        public void run() {
            // Database task
        }
    };

    Future<?> f = service.submit(r);

    f.get(2, TimeUnit.MINUTES);     // attempt the task for two minutes
}
catch (final InterruptedException e) {
    // The thread was interrupted during sleep, wait or join
}
catch (final TimeoutException e) {
    // Took too long!
}
catch (final ExecutionException e) {
    // An exception from within the Runnable task
}
finally {
    service.shutdown();
}
```

## Produced APIzation

[`APIzator4044793.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator4044793.java)

```java
package com.stackoverflow.api;

import io.netty.util.Timer;
import io.netty.util.TimerTask;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

/**
 * How to set a Timer in Java?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/4044793">https://stackoverflow.com/a/4044793</a>
 */
public class APIzator4044793 {

  public static void setTimer() throws RuntimeException {
    Timer timer = new Timer();
    timer.schedule(
      new TimerTask() {

        @Override
        public void run() {
          // Your database code here
        }
      },
      2 * 60 * 1000
    );
    timer.scheduleAtFixedRate(
      new TimerTask() {

        @Override
        public void run() {
          // Your database code here
        }
      },
      2 * 60 * 1000,
      2 * 60 * 1000
    );
    ExecutorService service = Executors.newSingleThreadExecutor();
    try {
      Runnable r = new Runnable() {

        @Override
        public void run() {
          // Database task
        }
      };
      Future<?> f = service.submit(r);
      // attempt the task for two minutes
      f.get(2, TimeUnit.MINUTES);
    } catch (final InterruptedException e) {
      // The thread was interrupted during sleep, wait or join
    } catch (final TimeoutException e) {
      // Took too long!
    } catch (final ExecutionException e) {
      // An exception from within the Runnable task
    } finally {
      service.shutdown();
    }
  }
}

```