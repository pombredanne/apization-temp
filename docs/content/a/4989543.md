---
title: "[Q#4989182][A#4989543] converting Java bitmap to byte array"
question_title: "converting Java bitmap to byte array"
question_text: "When I look at the buffer after the call to copyPixelsToBuffer the bytes are all 0... The bitmap returned from the camera is immutable... but that shouldn't matter since it's doing a copy. What could be wrong with this code?"
answer_text: "Try something like this:"
apization_code: "package com.stackoverflow.api;  import android.graphics.Bitmap; import java.io.ByteArrayOutputStream;  /**  * converting Java bitmap to byte array  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/4989543\">https://stackoverflow.com/a/4989543</a>  */ public class APIzator4989543 {    public static void convert() throws RuntimeException {     Bitmap bmp = intent.getExtras().get(\"data\");     ByteArrayOutputStream stream = new ByteArrayOutputStream();     bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);     byte[] byteArray = stream.toByteArray();     bmp.recycle();   } }"
---

https://stackoverflow.com/q/4989182

When I look at the buffer after the call to copyPixelsToBuffer the bytes are all 0... The bitmap returned from the camera is immutable... but that shouldn&#x27;t matter since it&#x27;s doing a copy.
What could be wrong with this code?


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
Bitmap bmp   = intent.getExtras().get("data");
  int size     = bmp.getRowBytes() * bmp.getHeight();
  ByteBuffer b = ByteBuffer.allocate(size);

  bmp.copyPixelsToBuffer(b);

  byte[] bytes = new byte[size];

  try {
     b.get(bytes, 0, bytes.length);
  } catch (BufferUnderflowException e) {
     // always happens
  }
  // do something with byte[]
```


## Original code snippet

https://stackoverflow.com/a/4989543

Try something like this:

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
Bitmap bmp = intent.getExtras().get("data");
ByteArrayOutputStream stream = new ByteArrayOutputStream();
bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);
byte[] byteArray = stream.toByteArray();
bmp.recycle();
```

## Produced APIzation

[`APIzator4989543.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/search/APIzator4989543.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

import android.graphics.Bitmap;
import java.io.ByteArrayOutputStream;

/**
 * converting Java bitmap to byte array
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/4989543">https://stackoverflow.com/a/4989543</a>
 */
public class APIzator4989543 {

  public static void convert() throws RuntimeException {
    Bitmap bmp = intent.getExtras().get("data");
    ByteArrayOutputStream stream = new ByteArrayOutputStream();
    bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);
    byte[] byteArray = stream.toByteArray();
    bmp.recycle();
  }
}

```