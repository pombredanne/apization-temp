---
title: "[Q#14617][A#15937] How to retrieve a file from a server via SFTP?"
question_title: "How to retrieve a file from a server via SFTP?"
question_text: "I'm trying to retrieve a file from a server using SFTP (as opposed to FTPS) using Java. How can I do this?"
answer_text: "Another option is to consider looking at the JSch library. JSch seems to be the preferred library for a few large open source projects, including Eclipse, Ant and Apache Commons HttpClient, amongst others. It supports both user/pass and certificate-based logins nicely, as well as all a whole host  of other yummy SSH2 features. Here's a simple remote file retrieve over SFTP. Error handling is left as an exercise for the reader :-)"
apization_code: "package com.stackoverflow.api;  import com.jcraft.jsch.JSch; import com.jcraft.jsch.UserInfo; import org.h2.engine.Session;  /**  * How to retrieve a file from a server via SFTP?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/15937\">https://stackoverflow.com/a/15937</a>  */ public class APIzator15937 {    public static void retrieveFile(String knownHostsFilename)     throws RuntimeException {     JSch jsch = new JSch();     jsch.setKnownHosts(knownHostsFilename);     Session session = jsch.getSession(\"remote-username\", \"remote-host\");     {       // \"interactive\" version       // can selectively update specified known_hosts file       // need to implement UserInfo interface       // MyUserInfo is a swing implementation provided in       // examples/Sftp.java in the JSch dist       UserInfo ui = new MyUserInfo();       session.setUserInfo(ui);       // OR non-interactive version. Relies in host key being in known-hosts file       session.setPassword(\"remote-password\");     }     session.connect();     Channel channel = session.openChannel(\"sftp\");     channel.connect();     ChannelSftp sftpChannel = (ChannelSftp) channel;     sftpChannel.get(\"remote-file\", \"local-file\");     // OR     InputStream in = sftpChannel.get(\"remote-file\");     // process inputstream as needed     sftpChannel.exit();     session.disconnect();   } }"
---

https://stackoverflow.com/q/14617

I&#x27;m trying to retrieve a file from a server using SFTP (as opposed to FTPS) using Java. How can I do this?



## Original code snippet

https://stackoverflow.com/a/15937

Another option is to consider looking at the JSch library. JSch seems to be the preferred library for a few large open source projects, including Eclipse, Ant and Apache Commons HttpClient, amongst others.
It supports both user/pass and certificate-based logins nicely, as well as all a whole host  of other yummy SSH2 features.
Here&#x27;s a simple remote file retrieve over SFTP. Error handling is left as an exercise for the reader :-)

```java
JSch jsch = new JSch();

String knownHostsFilename = "/home/username/.ssh/known_hosts";
jsch.setKnownHosts( knownHostsFilename );

Session session = jsch.getSession( "remote-username", "remote-host" );    
{
  // "interactive" version
  // can selectively update specified known_hosts file 
  // need to implement UserInfo interface
  // MyUserInfo is a swing implementation provided in 
  //  examples/Sftp.java in the JSch dist
  UserInfo ui = new MyUserInfo();
  session.setUserInfo(ui);

  // OR non-interactive version. Relies in host key being in known-hosts file
  session.setPassword( "remote-password" );
}

session.connect();

Channel channel = session.openChannel( "sftp" );
channel.connect();

ChannelSftp sftpChannel = (ChannelSftp) channel;

sftpChannel.get("remote-file", "local-file" );
// OR
InputStream in = sftpChannel.get( "remote-file" );
  // process inputstream as needed

sftpChannel.exit();
session.disconnect();
```

## Produced APIzation

[`APIzator15937.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator15937.java)

```java
package com.stackoverflow.api;

import com.jcraft.jsch.JSch;
import com.jcraft.jsch.UserInfo;
import org.h2.engine.Session;

/**
 * How to retrieve a file from a server via SFTP?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/15937">https://stackoverflow.com/a/15937</a>
 */
public class APIzator15937 {

  public static void retrieveFile(String knownHostsFilename)
    throws RuntimeException {
    JSch jsch = new JSch();
    jsch.setKnownHosts(knownHostsFilename);
    Session session = jsch.getSession("remote-username", "remote-host");
    {
      // "interactive" version
      // can selectively update specified known_hosts file
      // need to implement UserInfo interface
      // MyUserInfo is a swing implementation provided in
      // examples/Sftp.java in the JSch dist
      UserInfo ui = new MyUserInfo();
      session.setUserInfo(ui);
      // OR non-interactive version. Relies in host key being in known-hosts file
      session.setPassword("remote-password");
    }
    session.connect();
    Channel channel = session.openChannel("sftp");
    channel.connect();
    ChannelSftp sftpChannel = (ChannelSftp) channel;
    sftpChannel.get("remote-file", "local-file");
    // OR
    InputStream in = sftpChannel.get("remote-file");
    // process inputstream as needed
    sftpChannel.exit();
    session.disconnect();
  }
}

```