---
title: "[Q#886722][A#886799] How to use wait and notify in Java without IllegalMonitorStateException?"
question_title: "How to use wait and notify in Java without IllegalMonitorStateException?"
question_text: "I have 2 matrices and I need to multiply them and then print the results of each cell. As soon as one cell is ready I need to print it, but for example I need to print the [0][0] cell before cell [2][0] even if the result of [2][0] is ready first. So I need to print it by order. So my idea is to make the printer thread wait until the multiplyThread notifies it that the correct cell is ready to be printed and then the printerThread will print the cell and go back to waiting and so on.. So I have this thread that does the multiplication: Thread that prints the result of each cell: Now it throws me these exceptions: line 49 in multiplyThread is the \"notify()\"..I think I need to use the synchronized differently but I am not sure how. If anyone can help this code to work I will really appreciate it."
answer_text: "To be able to call notify() you need to synchronize on the same object."
apization_code: "package com.stackoverflow.api;  /**  * How to use wait and notify in Java without IllegalMonitorStateException?  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/886799\">https://stackoverflow.com/a/886799</a>  */ public class APIzator886799 {    public static void useWait() throws RuntimeException {     synchronized (someObject) {       someObject.wait();     }     /* different thread / object */     synchronized (someObject) {       someObject.notify();     }   } }"
---

https://stackoverflow.com/q/886722

I have 2 matrices and I need to multiply them and then print the results of each cell. As soon as one cell is ready I need to print it, but for example I need to print the [0][0] cell before cell [2][0] even if the result of [2][0] is ready first. So I need to print it by order.
So my idea is to make the printer thread wait until the multiplyThread notifies it that the correct cell is ready to be printed and then the printerThread will print the cell and go back to waiting and so on..
So I have this thread that does the multiplication:
Thread that prints the result of each cell:
Now it throws me these exceptions:
line 49 in multiplyThread is the &quot;notify()&quot;..I think I need to use the synchronized differently but I am not sure how.
If anyone can help this code to work I will really appreciate it.


<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
public void run() 
{
    int countNumOfActions = 0; // How many multiplications have we done
    int maxActions = randomize(); // Maximum number of actions allowed

    for (int i = 0; i < size; i++)
    {       
        result[rowNum][colNum] = result[rowNum][colNum] + row[i] * col[i];
        countNumOfActions++;
        // Reached the number of allowed actions
        if (countNumOfActions >= maxActions)
        {
            countNumOfActions = 0;
            maxActions = randomize();
            yield();
        }   
    }
    isFinished[rowNum][colNum] = true;
    notify();
}
public void run()
{
    int j = 0; // Columns counter
    int i = 0; // Rows counter
    System.out.println("The result matrix of the multiplication is:");

    while (i < creator.getmThreads().length)
    {
        synchronized (this)
        {
            try 
            {
                this.wait();
            } 
            catch (InterruptedException e1) 
            {
            }
        }
        if (creator.getmThreads()[i][j].getIsFinished()[i][j] == true)
        {
            if (j < creator.getmThreads()[i].length)
            {
                System.out.print(creator.getResult()[i][j] + " ");
                j++;
            }
            else
            {
                System.out.println();
                j = 0;
                i++;
                System.out.print(creator.getResult()[i][j] + " ");
            }
        }
    }
Exception in thread "Thread-9" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-6" Exception in thread "Thread-4" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-5" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-8" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-7" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-11" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-10" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
Exception in thread "Thread-12" java.lang.IllegalMonitorStateException
    at java.lang.Object.notify(Native Method)
    at multiplyThread.run(multiplyThread.java:49)
```


## Original code snippet

https://stackoverflow.com/a/886799

To be able to call notify() you need to synchronize on the same object.

<div class="code-logo"><img src="/stackoverflow.png" /></div>

```java
synchronized (someObject) {
    someObject.wait();
}

/* different thread / object */
synchronized (someObject) {
    someObject.notify();
}
```

## Produced APIzation

[`APIzator886799.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/search/APIzator886799.java)

<div class="code-logo"><img src="/apizator.png" /></div>

```java
package com.stackoverflow.api;

/**
 * How to use wait and notify in Java without IllegalMonitorStateException?
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/886799">https://stackoverflow.com/a/886799</a>
 */
public class APIzator886799 {

  public static void useWait() throws RuntimeException {
    synchronized (someObject) {
      someObject.wait();
    }
    /* different thread / object */
    synchronized (someObject) {
      someObject.notify();
    }
  }
}

```