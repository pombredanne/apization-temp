---
title: "[Q#4246646][A#4246686] MySQL & Java - Get id of the last inserted value (JDBC)"
question_title: "MySQL & Java - Get id of the last inserted value (JDBC)"
question_text: "Possible Duplicate: How to get the insert ID in JDBC? Hi, I'm using JDBC to connect on database through out Java. Now, I do some insert query, and I need to get the id of last inserted value (so, after a stmt.executeUpdate). I don't need something like SELECT id FROM table ORDER BY id DESC LIMIT 1, because I may have concurrency problems. I Just need to retrieve the id associated to the last insertion (about my instance of the Statement). I tried this, but seems it doesn't work on JDBC : In fact, every time risultato = -1, and I get java.sql.SQLException: Generated keys not requested. You need to specify Statement.RETURN_GENERATED_KEYS to Statement.executeUpdate() or Connection.prepareStatement(). How can I fix this problem? Thanks Stackoverflow People :)"
answer_text: "Wouldn't you just change: to: Take a look at the documentation for the JDBC Statement interface. Update: Apparently there is a lot of confusion about this answer, but my guess is that the people that are confused are not reading it in the context of the question that was asked. If you take the code that the OP provided in his question and replace the single line (line 6) that I am suggesting, everything will work. The numero variable is completely irrelevant and its value is never read after it is set."
apization_code: "package com.stackoverflow.api;  import com.amazonaws.auth.policy.Statement;  /**  * MySQL & Java - Get id of the last inserted value (JDBC)  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/4246686\">https://stackoverflow.com/a/4246686</a>  */ public class APIzator4246686 {    public static void getI() throws RuntimeException {     numero = stmt.executeUpdate(query);     numero = stmt.executeUpdate(query, Statement.RETURN_GENERATED_KEYS);   } }"
---

https://stackoverflow.com/q/4246646

Possible Duplicate:
How to get the insert ID in JDBC?
Hi, I&#x27;m using JDBC to connect on database through out Java.
Now, I do some insert query, and I need to get the id of last inserted value (so, after a stmt.executeUpdate).
I don&#x27;t need something like SELECT id FROM table ORDER BY id DESC LIMIT 1, because I may have concurrency problems.
I Just need to retrieve the id associated to the last insertion (about my instance of the Statement).
I tried this, but seems it doesn&#x27;t work on JDBC :
In fact, every time risultato = -1, and I get java.sql.SQLException: Generated keys not requested. You need to specify Statement.RETURN_GENERATED_KEYS to Statement.executeUpdate() or Connection.prepareStatement().
How can I fix this problem? Thanks Stackoverflow People :)


```java
public Integer insertQueryGetId(String query) {
    Integer numero=0;
    Integer risultato=-1;
    try {
        Statement stmt = db.createStatement();
        numero = stmt.executeUpdate(query);

        ResultSet rs = stmt.getGeneratedKeys();
        if (rs.next()){
            risultato=rs.getInt(1);
        }
        rs.close();

        stmt.close();
    } catch (Exception e) {
        e.printStackTrace();
        errore = e.getMessage();
        risultato=-1;
    }
  return risultato;
}
```


## Original code snippet

https://stackoverflow.com/a/4246686

Wouldn&#x27;t you just change:
to:
Take a look at the documentation for the JDBC Statement interface.
Update: Apparently there is a lot of confusion about this answer, but my guess is that the people that are confused are not reading it in the context of the question that was asked. If you take the code that the OP provided in his question and replace the single line (line 6) that I am suggesting, everything will work. The numero variable is completely irrelevant and its value is never read after it is set.

```java
numero = stmt.executeUpdate(query);
numero = stmt.executeUpdate(query, Statement.RETURN_GENERATED_KEYS);
```

## Produced APIzation

[`APIzator4246686.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator4246686.java)

```java
package com.stackoverflow.api;

import com.amazonaws.auth.policy.Statement;

/**
 * MySQL & Java - Get id of the last inserted value (JDBC)
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/4246686">https://stackoverflow.com/a/4246686</a>
 */
public class APIzator4246686 {

  public static void getI() throws RuntimeException {
    numero = stmt.executeUpdate(query);
    numero = stmt.executeUpdate(query, Statement.RETURN_GENERATED_KEYS);
  }
}

```