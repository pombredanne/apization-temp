---
title: "[Q#16675191][A#16675399] Get full URL and query string in Servlet for both HTTP and HTTPS requests"
question_title: "Get full URL and query string in Servlet for both HTTP and HTTPS requests"
question_text: "I am writing a code which task is to retrieve a requested URL or full path. I've written this code: So, when I browse http://google.com?q=abc it is OK (correct). But there is problem when I browse https://google.com. The value of uri is http://google.com:443google.com:443, So the program doesn't only when HTTPS is used. And the output is same for request.getRequestURL().toString(). What is the solution?"
answer_text: "By design, getRequestURL() gives you the full URL, missing only the query string. In HttpServletRequest, you can get individual parts of the URI using the methods below: This snippet above will get the full URI, hiding the port if the default one was used, and not adding the \"?\" and the query string if the latter was not provided.  Note, that if your request passes through a proxy, you need to look at the X-Forwarded-Proto header since the scheme might be altered: Also, a common header is X-Forwarded-For, which show the original request IP instead of the proxys IP. If you are responsible for the configuration of the proxy/load balancer yourself, you need to ensure that these headers are set upon forwarding."
apization_code: "package com.stackoverflow.api;  /**  * Get full URL and query string in Servlet for both HTTP and HTTPS requests  *  * @author APIzator  * @see <a href=\"https://stackoverflow.com/a/16675399\">https://stackoverflow.com/a/16675399</a>  */ public class APIzator16675399 {    public static void getUrl() throws RuntimeException {     // Example: http://myhost:8080/people?lastname=Fox&amp;age=30     String uri = // \"http\" + \"://       request.getScheme() +       \"://\" + // \"myhost\"       request.getServerName() + // \":\"       \":\" + // \"8080\"       request.getServerPort() + // \"/people\"       request.getRequestURI() + // \"?\"       \"?\" + // \"lastname=Fox&amp;age=30\"       request.getQueryString();     String uri =       request.getScheme() +       \"://\" +       request.getServerName() +       (         \"http\".equals(request.getScheme()) &&           request.getServerPort() == 80 ||           \"https\".equals(request.getScheme()) &&           request.getServerPort() == 443           ? \"\"           : \":\" + request.getServerPort()       ) +       request.getRequestURI() +       (request.getQueryString() != null ? \"?\" + request.getQueryString() : \"\");   } }"
---

https://stackoverflow.com/q/16675191

I am writing a code which task is to retrieve a requested URL or full path. I&#x27;ve written this code:
So, when I browse http://google.com?q=abc it is OK (correct).
But there is problem when I browse https://google.com. The value of uri is http://google.com:443google.com:443, So the program doesn&#x27;t only when HTTPS is used.
And the output is same for request.getRequestURL().toString().
What is the solution?


```java
HttpServletRequest request;//obtained from other functions
String uri = request.getRequestURI();
if (request.getQueryString() != null)
    uri += "?" + request.getQueryString();
```


## Original code snippet

https://stackoverflow.com/a/16675399

By design, getRequestURL() gives you the full URL, missing only the query string.
In HttpServletRequest, you can get individual parts of the URI using the methods below:
This snippet above will get the full URI, hiding the port if the default one was used, and not adding the &quot;?&quot; and the query string if the latter was not provided.

Note, that if your request passes through a proxy, you need to look at the X-Forwarded-Proto header since the scheme might be altered:
Also, a common header is X-Forwarded-For, which show the original request IP instead of the proxys IP.
If you are responsible for the configuration of the proxy/load balancer yourself, you need to ensure that these headers are set upon forwarding.

```java
// Example: http://myhost:8080/people?lastname=Fox&age=30

String uri = request.getScheme() + "://" +   // "http" + "://
             request.getServerName() +       // "myhost"
             ":" +                           // ":"
             request.getServerPort() +       // "8080"
             request.getRequestURI() +       // "/people"
             "?" +                           // "?"
             request.getQueryString();       // "lastname=Fox&age=30"
String uri = request.getScheme() + "://" +
             request.getServerName() + 
             ("http".equals(request.getScheme()) && request.getServerPort() == 80 || "https".equals(request.getScheme()) && request.getServerPort() == 443 ? "" : ":" + request.getServerPort() ) +
             request.getRequestURI() +
            (request.getQueryString() != null ? "?" + request.getQueryString() : "");
request.getHeader("X-Forwarded-Proto")
request.getHeader("X-Forwarded-For")
```

## Produced APIzation

[`APIzator16675399.java`](https://github.com/pasqualesalza/apization-temp-data/raw/master/apizations/java/APIzator16675399.java)

```java
package com.stackoverflow.api;

/**
 * Get full URL and query string in Servlet for both HTTP and HTTPS requests
 *
 * @author APIzator
 * @see <a href="https://stackoverflow.com/a/16675399">https://stackoverflow.com/a/16675399</a>
 */
public class APIzator16675399 {

  public static void getUrl() throws RuntimeException {
    // Example: http://myhost:8080/people?lastname=Fox&amp;age=30
    String uri = // "http" + "://
      request.getScheme() +
      "://" + // "myhost"
      request.getServerName() + // ":"
      ":" + // "8080"
      request.getServerPort() + // "/people"
      request.getRequestURI() + // "?"
      "?" + // "lastname=Fox&amp;age=30"
      request.getQueryString();
    String uri =
      request.getScheme() +
      "://" +
      request.getServerName() +
      (
        "http".equals(request.getScheme()) &&
          request.getServerPort() == 80 ||
          "https".equals(request.getScheme()) &&
          request.getServerPort() == 443
          ? ""
          : ":" + request.getServerPort()
      ) +
      request.getRequestURI() +
      (request.getQueryString() != null ? "?" + request.getQueryString() : "");
  }
}

```